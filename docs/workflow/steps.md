# Разбираемся в процессе Data Science Lifecycle Process

Важно понимать, что прогресс в проекте по работе с данными нелинеен. Проекты Data Science цикличны и экспериментальны по своей природе. По мере того, как понимание данных и проблемы возрастает, мы часто пересматриваем предыдущие подходы и вносим коррективы. Мы можем даже изменить постановку задачи, чтобы получить более полезный результат. В связи с этим возможны переходы между практически любыми этапами.

Тем не менее, для простоты опишем этапы в том порядке, в котором они встречаются в процессе. На практике вы будете часто переходить между этапами. Если вы понимаете цель каждого этапа, перемещение между ними будет довольно интуитивно понятным.

## 1. Создание Ask Issue

Первый шаг любого проекта - **это постановка задачи**. Нам нужно определить, что мы на самом деле пытаемся сделать и зачем нам это нужно. Именно для этого предназначена задача типа Ask (Вопрос).

На этом этапе команда специалистов по данным взаимодействует с заинтересованными сторонами, чтобы понять предметную область и начать формулировать проблему как задачу Data Science.

На этом этапе вам нужно зафиксировать существующие рабочие процессы, недостатки и потенциальное влияние, как указано в шаблоне задачи Ask.

Помните, что вам не нужно выяснять все сразу. Заполните столько, сколько сможете. Вы будете продолжать обновлять и уточнять задачу по мере продвижения и углубления понимания проблемы.

Цель на данном этапе - создать отправную точку для вашей работы и убедиться, что вы решаете правильную проблему. Как только вы почувствуете, что достигли общего понимания проблемы, вам нужно будет получить данные.

### Обновление Ask Issue

В процессе решения задачи вы будете узнавать больше о данных и лучше понимать саму проблему. По мере этого вам следует обновлять задачу типа Ask (Вопрос). Это может включать в себя уточнение области задачи, определение дополнительных источников данных, изменение метрик и т. д.

Задача типа Ask всегда должна отражать текущее понимание проблемы и пути ее решения командой.

### Следующие шаги

- Проведите исследование, чтобы лучше разобраться в проблеме
- Взаимодействуйте с заинтересованными сторонами и получайте обратную связь
- Создайте Data Issue, чтобы получить данные для решения проблемы

## 2. Создание задач сбора данных

После постановки задачи, вам понадобятся данные. Это либо существующие, доступные датасеты, либо вам нужно будет их создать. В любом случае, вам нужно будет создать одну из двух вариантов задач сбора данных (обобщенно - Data Issue), чтобы зафиксировать **требования и определение того, какие данные вам нужны и для чего**.

> Для каждого датасета, необходимого для решения проблемы, стоит создать ссылку на задачи Data Issue в задачах Ask Issue.

### 2.1 Сбор данных

**Создайте задачу Data Acquisition** для загрузки необходимых наборов данных из существующего источника. Часто вам нужно сотрудничать с другими командами, чтобы сделать это. Задача является отличной площадкой для этого. После того, как вы описали начальное определение, **создайте в репозитории data-ветку** (о ветках см в [Стратегия ветвления](branch-types.md)) для разработки пайплайна загрузки.

### 2.2 Создание данных

Часто вам нужно создать собственные данные, либо по-новому объединяя существующие датасеты, либо создавая конвейеры для сбора данных из новых источников. В этом случае вы должны **открыть задачу Data Creation** для совместной работы над описанием и созданием нового датасета. **Создайте data-ветку** для разработки нового пайплайна.

### 2.3 Валидация данных

Когда вы проверили данные и убедились, что они соответствуют вашим требованиям, **влейте data-ветку в ветку `main` при помощи Pull Request** и закройте задачу. Не забудьте включить документацию для всех наборов данных.

#### Тесты и схемы

Хорошая идея - написать тесты для проверки данных и зафиксировать описание схемы данных на этом шаге. Это уменьшит проблемы позже и создаст больше ясности для команды.

### Следующие шаги

- Исследуйте данные
- Создайте дополнительную документацию
- Обновите и актуализируйте задачу Ask Issue на основе имеющихся данных

## 3. Создание Explore Issues

Чтобы решить проблему, вам нужно лучше разобраться в данных. Лучший способ сделать это - провести их исследование (EDA).

Создавайте задачи типа Explore (Исследование) на протяжении всего проекта, когда вам нужно углубить свое понимание данных и их влияние на проблему. По возможности, заранее составьте список вопросов, на которые вы хотите получить ответы. Это поможет вам не сбиться с пути и не затянуть исследование. Если вы не можете сформулировать цели заранее, ограничьте время исследования.

#### Связь задач типа Explore 

Важно связывать ваши задачи типа Explore с другими задачами (Ask, Data, Experiment и т. д.), чтобы вы могли легко найти их позже. Вы должны связывать задачи Explore с тем типом задачи, который побудил их создание. Например, если вы исследуете датасет, полученный из другого источника, чтобы разработать пайплайн, задачу Explore стоит связать с исходной Data задачей. Если же вы исследуете данные, чтобы понять, какую поставить задачу или чтобы проверить предположения, стоит связать задачу Explore с исходными задачами Ask или Experiment.

### 3.1 Создание ветки Explore Branch

Создайте explore-ветку в репозитории для исследования данных и совместной работы. Зафиксируйте главные выводы изысканий (т.е. TLDR) в соответствующей Explore задаче, чтобы другие могли понять что вы выяснили. Обязательно свяжите Pull Request с задачей ([вот так](https://docs.github.com/en/issues/tracking-your-work-with-issues/using-issues/linking-a-pull-request-to-an-issue)), чтобы другие могли не только прочитать, но и посмотреть ваши исследования.


### 3.2 Review и закрытие

Explore-ветки (Explore branches) **не сливаются** с веткой `main`, поскольку их сложно поддерживать и они приводят к раздуванию репозитория. Вместо этого по завершении исследования можно отметить PR (Pull Request) для проверки (review), если хотите, чтобы другие участники команды увидели, что вы обнаружили. После этого закройте PR и связанную с ним задачу без слияние веток. Также обновите другие задачи, основываясь на вашем новом понимании данных.

Если в задаче исследования обнаружена критически важная информация, то ее решением должно стать обновление документации.

### 3.3 Рефакторинг полезные компоненты

Often during exploration, you'll uncover useful examples or create utility functions that will have persistent value. If so, you should create another issue and feature branch to add new code or documentation in the collaboration branch.

Часто во время исследования вы обнаружите полезные примеры или создадите утилиты, имеющие самостоятельную ценность. В таком случае, создайте другую задачу и feature-ветку для добавления нового кода или документации (в потом PR в main).

### Следующие шаги

- Обновить задачу типа Ask (Вопрос)
- Провести дополнительные исследования
- Уточнить/исправить данные
- Получить больше данных
- Начать эксперимент
- Добавить тесты к коду
- Рефакторить полезные компоненты, созданные во время исследования
- Обновить документацию на основе нового понимания

## 4. Создание Experiment Issues

Когда вы поняли проблему и данные, вы будете экспериментировать с различными подходами к решению. Это будет включать в себя создание целевых показателей, признаков, моделей, пользовательских метрик оценки и т. д.

Для каждого подхода, который вы попробуете, вам нужно будет создать задачу типа Experiment (Эксперимент). Это позволит вам и вашей команде отслеживать различные подходы и их результаты.

Создавая experiment-ветки для каждого эксперимента, мы можем изолировать эксперименты друг от друга и совместно работать над ними.

По мере создания фрагментов полезного, многократно используемого кода (метрики, функции оценки, признаки и т. д.), вам нужно будет создавать новые feature-ветки, чтобы вы могли объединить их с веткой main, чтобы вы и другие могли использовать их в будущих экспериментах.

### Следуюшие шаги:

#### Если неудача:

1. Напишите краткое описание (TLDR) результата и причины неудачи.
1. Отметьте эксперимент как неудачный, используя метку.
1. Закройте Pull Request и experiment-задачу без слияние.
1. Обновите задачу типа Ask (Вопрос) соответствующим образом.

Затем:

- Попробуйте еще эксперименты
- Обновите данные
- Исследуйте данные
- Обновите задачу типа Ask (Вопрос)

#### Если успех:

1. Обновите experiment-задачу, добавив TLDR и отметив ее как успешную с помощью метки.
2. Создайте задачу типа Model (Модель) для подготовки модели и конвейеров к развертыванию.
3. Создайте model-ветку, используя ветку на основе `main`.
4. Влейте (merge) текущие изменения из ветки `main` в вашу experiment-ветку и разрешите все конфликты.
5. Измените цель (target) Pull Request-а эксперимента на созданную model-ветку.
6. Влейте Pull Reuest в model-ветку и закройте задачу эксперимента.
7. Удалите experiment-ветку.

## 5. Создание Model Issue

После успешного эксперимента, вы захотите его развернуть. Создайте задачу типа Model (Модель), чтобы отслеживать все необходимые шаги для развертывания. Это может включать в себя:

- Рефакторинг признаков, чтобы они соответствовали требованиям производственной среды
- Написание тестов для признаков, моделей и наборов данных
- Регистрацию и упаковку модели для развертывания
- Развертывание и тестирование полного ML-конвейера на всех обучающих данных
- Тестирование производительности и устойчивости модели
- Добавление мониторинга и логирования
- Создание плана выпуска (release plan), например, A/B-тестирование, стратегия отката и т.п., и плана переобучения модели

> По мере развития вашей команды вы можете начать автоматизировать больше этих шагов, используя CI/CD и MLOps.

## 6. Повторить

Продолжайте и переключайтесь между этими шагами, пока вы не решите проблему и не получите решение в производственной среде.

## Следующие шаги

- [Изучить Branching Strategy](./branch-types.md)
- [Изучить Issue Types](./issue-types/0-overview-issue-types.md)
